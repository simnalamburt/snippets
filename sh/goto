#!/bin/bash

# fzfë¡œ ì›í•˜ëŠ” íŒŒì¼ ë‚´ìš©ì„ ê²€ìƒ‰í•œ ë’¤, vimìœ¼ë¡œ ì—´ì–´ì£¼ëŠ” í”„ë¡œê·¸ë¨.
# ë‹¤ì¤‘ì„ íƒë„ ì§€ì›í•œë‹¤
#
# Special thanks to @xnuk https://github.com/xnuk/

set -euo pipefail; IFS=$'\n\t'

ARGS=$(
  rg --no-config -nH0 --color=always '\A' --replace 'ğŸŒğŸ”¥ğŸ¸ğŸ¹ğŸ˜‚ğŸ˜ğŸ˜˜' |
    fzf --tac --ansi --multi --delimiter='\0|ğŸŒğŸ”¥ğŸ¸ğŸ¹ğŸ˜‚ğŸ˜ğŸ˜˜' --nth='2..' --with-nth='1,3..' |
    rg --no-config -a '\A(.*)\x00(.*):ğŸŒğŸ”¥ğŸ¸ğŸ¹ğŸ˜‚ğŸ˜ğŸ˜˜(.*)$' --replace ' +"tabnew +$2 $1"' |
    tr -d '\n'
)

eval "vim${ARGS} +1tabclose"
